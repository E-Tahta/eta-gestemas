From: =?utf-8?q?Yunusemre_=C5=9Eent=C3=BCrk?=
 <yunusemre.senturk@pardus.org.tr>
Date: Thu, 22 Feb 2018 17:09:34 +0300
Subject: Redesign eta_gestemas wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

Signed-off-by: Yunusemre Şentürk <yunusemre.senturk@pardus.org.tr>
---
 eta_gestemas | 15 ++++++++++++---
 1 file changed, 12 insertions(+), 3 deletions(-)

diff --git a/eta_gestemas b/eta_gestemas
index b846fd1..a2fc07b 100755
--- a/eta_gestemas
+++ b/eta_gestemas
@@ -15,10 +15,19 @@ echo -e "${YEL}$0${NC} : running as ${YEL}$u" >> $LOG_FILE
 
 while true
 do
+    pid=$(pgrep -f "/usr/bin/eta-gestemas")
     if [[ -f $OPTICTOUCH_PID ]]; then
-        sleep 3
-        echo -e "${YEL}$0${NC} : optictouch pid found calling ${YEL}/usr/bin/eta-gestemas" >> $LOG_FILE
-        /usr/bin/eta-gestemas
+        if [  -z "$pid" ]; then
+            sleep 3
+            echo -e "${YEL}$0${NC} : optictouch pid found calling ${YEL}/usr/bin/eta-gestemas" >> $LOG_FILE
+            /usr/bin/eta-gestemas &
+        fi
+    else
+        if [ ! -z "$pid" ]; then
+            echo -e "${YEL}$0${NC} : optictouch pid not found terminating ${YEL}eta-gestemas" >> $LOG_FILE
+            kill ${pid}
+        fi
     fi
     sleep 1
 done
+
