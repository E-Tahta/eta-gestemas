From: =?utf-8?q?Yunusemre_=C5=9Eent=C3=BCrk?=
 <yunusemre.senturk@pardus.org.tr>
Date: Mon, 4 Dec 2017 16:53:29 +0300
Subject: Update wrapper script and make it faster

---
 eta_gestemas | 31 ++++++++++++-------------------
 1 file changed, 12 insertions(+), 19 deletions(-)

diff --git a/eta_gestemas b/eta_gestemas
index 4cf0aa7..b846fd1 100755
--- a/eta_gestemas
+++ b/eta_gestemas
@@ -4,28 +4,21 @@ YEL='\033[1;33m'
 GREEN='\033[0;32m'
 NC='\033[0m' # No Color
 
-echo -e "${YEL}$0" >> /tmp/eta_log
-u=`/usr/bin/whoami`
-echo -e "${YEL}$0 ${NC}running as ${YEL}$u" >> /tmp/eta_log
-
-if [ ! -f /tmp/optic_touch.pid ]; then
-    echo -e "${YEL}$0 ${NC}calling ${YEL}/usr/bin/eta-optictouch-busy &" >> /tmp/eta_log
-    /usr/bin/eta-optictouch-busy &
-fi
-
-while [ ! -f /tmp/optic_touch.pid ]
-do
-    sleep 1
-done
+LOG_FILE=/var/log/eta.log
+OPTICTOUCH_PID=/var/run/optictouch.pid
 
-echo -e "${YEL}$0 ${NC}eta_gestemas check optic touch loop is ${GREEN}ok!" >> /tmp/eta_log
-echo -e "${YEL}$0 ${NC}terminating every ${YEL}eta-optictouch-busy" >> /tmp/eta_log
-killall eta-optictouch-busy
-sleep 2
+echo -e "${YEL}$0" >> $LOG_FILE
+u=`/usr/bin/whoami`
+echo -e "${YEL}$0${NC} : running as ${YEL}$u" >> $LOG_FILE
 
 # When eta-gestemas crashes this loop brings it back.
 
-while true; do
-    /usr/bin/eta-gestemas
+while true
+do
+    if [[ -f $OPTICTOUCH_PID ]]; then
+        sleep 3
+        echo -e "${YEL}$0${NC} : optictouch pid found calling ${YEL}/usr/bin/eta-gestemas" >> $LOG_FILE
+        /usr/bin/eta-gestemas
+    fi
     sleep 1
 done
